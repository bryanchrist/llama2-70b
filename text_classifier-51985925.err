  Running command git clone --quiet https://github.com/huggingface/peft.git /tmp/pip-install-zpuowx3l/peft_47730277bbb14765b9a5bbaa18485077
  Running command git clone --quiet https://github.com/huggingface/accelerate.git /tmp/pip-install-zpuowx3l/accelerate_9da5ad15b5fc4525ba69c0cdadd3c32c
Found cached dataset csv (/home/brc4cb/.cache/huggingface/datasets/csv/default-10416fda93fda02b/0.0.0/eea64c71ca8b46dd3f537ed218fc9bf495d5707789152eb2764f5c78fa66d59d)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 238.03it/s]
Loading cached shuffled indices for dataset at /home/brc4cb/.cache/huggingface/datasets/csv/default-10416fda93fda02b/0.0.0/eea64c71ca8b46dd3f537ed218fc9bf495d5707789152eb2764f5c78fa66d59d/cache-789e2502999e7416.arrow
Loading cached shuffled indices for dataset at /home/brc4cb/.cache/huggingface/datasets/csv/default-10416fda93fda02b/0.0.0/eea64c71ca8b46dd3f537ed218fc9bf495d5707789152eb2764f5c78fa66d59d/cache-789e2502999e7416.arrow
Loading cached shuffled indices for dataset at /home/brc4cb/.cache/huggingface/datasets/csv/default-10416fda93fda02b/0.0.0/eea64c71ca8b46dd3f537ed218fc9bf495d5707789152eb2764f5c78fa66d59d/cache-789e2502999e7416.arrow
/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/transformers/tokenization_utils_base.py:1714: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
Loading cached processed dataset at /home/brc4cb/.cache/huggingface/datasets/csv/default-10416fda93fda02b/0.0.0/eea64c71ca8b46dd3f537ed218fc9bf495d5707789152eb2764f5c78fa66d59d/cache-76e2a086a1ae0172.arrow
Loading cached processed dataset at /home/brc4cb/.cache/huggingface/datasets/csv/default-10416fda93fda02b/0.0.0/eea64c71ca8b46dd3f537ed218fc9bf495d5707789152eb2764f5c78fa66d59d/cache-fa6d25c327844683.arrow
Loading cached processed dataset at /home/brc4cb/.cache/huggingface/datasets/csv/default-10416fda93fda02b/0.0.0/eea64c71ca8b46dd3f537ed218fc9bf495d5707789152eb2764f5c78fa66d59d/cache-89d5a97023020906.arrow
/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/transformers/modeling_utils.py:2193: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:12<00:12, 12.33s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:16<00:00,  7.42s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:16<00:00,  8.16s/it]
Some weights of LlamaForSequenceClassification were not initialized from the model checkpoint at meta-llama/Llama-2-7b-hf and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
wandb: Currently logged in as: brc4cb (christ_research). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.15.8 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.3
wandb: Run data is saved locally in /gpfs/gpfs0/project/SDS/research/christ_research/Llama 2/llama2-70b/wandb/run-20230804_114659-4432da36
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run light-valley-23
wandb: ⭐️ View project at https://wandb.ai/christ_research/huggingface
wandb: 🚀 View run at https://wandb.ai/christ_research/huggingface/runs/4432da36
  0%|          | 0/3744 [00:00<?, ?it/s]You're using a LlamaTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
  0%|          | 1/3744 [00:03<3:15:08,  3.13s/it]  0%|          | 2/3744 [00:03<1:35:28,  1.53s/it]  0%|          | 3/3744 [00:03<1:02:43,  1.01s/it]  0%|          | 4/3744 [00:04<48:19,  1.29it/s]    0%|          | 5/3744 [00:04<39:27,  1.58it/s]  0%|          | 6/3744 [00:05<34:05,  1.83it/s]  0%|          | 7/3744 [00:05<31:05,  2.00it/s]  0%|          | 8/3744 [00:05<29:36,  2.10it/s]  0%|          | 9/3744 [00:06<28:33,  2.18it/s]  0%|          | 10/3744 [00:06<27:08,  2.29it/s]  0%|          | 11/3744 [00:07<26:46,  2.32it/s]  0%|          | 12/3744 [00:07<26:19,  2.36it/s]  0%|          | 13/3744 [00:07<25:51,  2.41it/s]  0%|          | 14/3744 [00:08<25:31,  2.44it/s]  0%|          | 15/3744 [00:08<25:54,  2.40it/s]  0%|          | 16/3744 [00:09<25:00,  2.48it/s]  0%|          | 17/3744 [00:09<24:22,  2.55it/s]  0%|          | 18/3744 [00:09<25:12,  2.46it/s]  1%|          | 19/3744 [00:10<24:44,  2.51it/s]  1%|          | 20/3744 [00:10<24:29,  2.53it/s]  1%|          | 21/3744 [00:11<24:33,  2.53it/s]  1%|          | 22/3744 [00:11<24:15,  2.56it/s]  1%|          | 23/3744 [00:11<24:07,  2.57it/s]  1%|          | 24/3744 [00:12<24:41,  2.51it/s]  1%|          | 25/3744 [00:12<24:08,  2.57it/s]  1%|          | 26/3744 [00:13<24:20,  2.55it/s]  1%|          | 27/3744 [00:13<24:55,  2.49it/s]  1%|          | 28/3744 [00:13<24:32,  2.52it/s]  1%|          | 29/3744 [00:14<24:17,  2.55it/s]  1%|          | 30/3744 [00:14<24:27,  2.53it/s]  1%|          | 31/3744 [00:15<24:15,  2.55it/s]  1%|          | 32/3744 [00:15<25:10,  2.46it/s]  1%|          | 33/3744 [00:15<24:26,  2.53it/s]  1%|          | 34/3744 [00:16<24:13,  2.55it/s]  1%|          | 35/3744 [00:16<25:03,  2.47it/s]  1%|          | 36/3744 [00:17<24:52,  2.48it/s]  1%|          | 37/3744 [00:17<24:29,  2.52it/s]  1%|          | 38/3744 [00:17<24:13,  2.55it/s]  1%|          | 39/3744 [00:18<24:02,  2.57it/s]  1%|          | 40/3744 [00:18<23:57,  2.58it/s]  1%|          | 41/3744 [00:19<23:49,  2.59it/s]  1%|          | 42/3744 [00:19<23:40,  2.61it/s]  1%|          | 43/3744 [00:19<24:21,  2.53it/s]  1%|          | 44/3744 [00:20<24:25,  2.52it/s]  1%|          | 45/3744 [00:20<24:26,  2.52it/s]  1%|          | 46/3744 [00:20<24:07,  2.55it/s]  1%|▏         | 47/3744 [00:21<24:17,  2.54it/s]  1%|▏         | 48/3744 [00:21<24:48,  2.48it/s]  1%|▏         | 49/3744 [00:22<24:44,  2.49it/s]  1%|▏         | 50/3744 [00:22<24:21,  2.53it/s]  1%|▏         | 51/3744 [00:22<24:26,  2.52it/s]  1%|▏         | 52/3744 [00:23<24:29,  2.51it/s]  1%|▏         | 53/3744 [00:23<24:07,  2.55it/s]  1%|▏         | 54/3744 [00:24<23:59,  2.56it/s]  1%|▏         | 55/3744 [00:24<23:48,  2.58it/s]  1%|▏         | 56/3744 [00:24<24:26,  2.52it/s]  2%|▏         | 57/3744 [00:25<24:10,  2.54it/s]  2%|▏         | 58/3744 [00:25<24:47,  2.48it/s]  2%|▏         | 59/3744 [00:26<25:04,  2.45it/s]  2%|▏         | 60/3744 [00:26<25:22,  2.42it/s]  2%|▏         | 61/3744 [00:27<25:45,  2.38it/s]  2%|▏         | 62/3744 [00:27<25:21,  2.42it/s]  2%|▏         | 63/3744 [00:27<24:28,  2.51it/s]  2%|▏         | 64/3744 [00:28<24:50,  2.47it/s]  2%|▏         | 65/3744 [00:28<25:21,  2.42it/s]  2%|▏         | 66/3744 [00:29<24:43,  2.48it/s]  2%|▏         | 67/3744 [00:29<24:37,  2.49it/s]  2%|▏         | 68/3744 [00:29<24:36,  2.49it/s]  2%|▏         | 69/3744 [00:30<24:00,  2.55it/s]  2%|▏         | 70/3744 [00:30<24:26,  2.51it/s]  2%|▏         | 71/3744 [00:31<24:25,  2.51it/s]  2%|▏         | 72/3744 [00:31<24:08,  2.53it/s]  2%|▏         | 73/3744 [00:31<23:55,  2.56it/s]  2%|▏         | 74/3744 [00:32<24:04,  2.54it/s]  2%|▏         | 75/3744 [00:32<24:09,  2.53it/s]  2%|▏         | 76/3744 [00:33<24:36,  2.48it/s]  2%|▏         | 77/3744 [00:33<25:07,  2.43it/s]  2%|▏         | 78/3744 [00:33<24:34,  2.49it/s]  2%|▏         | 79/3744 [00:34<24:28,  2.50it/s]  2%|▏         | 80/3744 [00:34<24:28,  2.49it/s]  2%|▏         | 81/3744 [00:35<24:44,  2.47it/s]  2%|▏         | 82/3744 [00:35<24:16,  2.51it/s]  2%|▏         | 83/3744 [00:35<24:17,  2.51it/s]  2%|▏         | 84/3744 [00:36<24:54,  2.45it/s]  2%|▏         | 85/3744 [00:36<25:17,  2.41it/s]  2%|▏         | 86/3744 [00:37<24:37,  2.48it/s]  2%|▏         | 87/3744 [00:37<24:16,  2.51it/s]  2%|▏         | 88/3744 [00:37<25:00,  2.44it/s]  2%|▏         | 89/3744 [00:38<24:47,  2.46it/s]  2%|▏         | 90/3744 [00:38<24:41,  2.47it/s]  2%|▏         | 91/3744 [00:39<23:41,  2.57it/s]  2%|▏         | 92/3744 [00:39<23:35,  2.58it/s]  2%|▏         | 93/3744 [00:39<23:24,  2.60it/s]  3%|▎         | 94/3744 [00:40<24:02,  2.53it/s]  3%|▎         | 95/3744 [00:40<24:09,  2.52it/s]  3%|▎         | 96/3744 [00:40<23:53,  2.55it/s]  3%|▎         | 97/3744 [00:41<23:39,  2.57it/s]  3%|▎         | 98/3744 [00:41<24:31,  2.48it/s]  3%|▎         | 99/3744 [00:42<24:28,  2.48it/s]  3%|▎         | 100/3744 [00:42<24:05,  2.52it/s]  3%|▎         | 101/3744 [00:42<24:09,  2.51it/s]  3%|▎         | 102/3744 [00:43<25:53,  2.34it/s]  3%|▎         | 103/3744 [00:43<25:44,  2.36it/s]  3%|▎         | 104/3744 [00:44<26:00,  2.33it/s]  3%|▎         | 105/3744 [00:44<24:51,  2.44it/s]  3%|▎         | 106/3744 [00:45<24:20,  2.49it/s]  3%|▎         | 107/3744 [00:45<24:58,  2.43it/s]  3%|▎         | 108/3744 [00:45<24:23,  2.48it/s]  3%|▎         | 109/3744 [00:46<24:54,  2.43it/s]  3%|▎         | 110/3744 [00:46<24:42,  2.45it/s]  3%|▎         | 111/3744 [00:47<24:15,  2.50it/s]  3%|▎         | 112/3744 [00:47<23:55,  2.53it/s]  3%|▎         | 113/3744 [00:47<23:44,  2.55it/s]  3%|▎         | 114/3744 [00:48<23:53,  2.53it/s]  3%|▎         | 115/3744 [00:48<25:02,  2.42it/s]  3%|▎         | 116/3744 [00:49<24:30,  2.47it/s]  3%|▎         | 117/3744 [00:49<24:03,  2.51it/s]  3%|▎         | 118/3744 [00:49<24:07,  2.51it/s]  3%|▎         | 119/3744 [00:50<24:06,  2.51it/s]  3%|▎         | 120/3744 [00:50<24:48,  2.43it/s]  3%|▎         | 121/3744 [00:51<25:14,  2.39it/s]  3%|▎         | 122/3744 [00:51<24:38,  2.45it/s]  3%|▎         | 123/3744 [00:52<25:08,  2.40it/s]  3%|▎         | 124/3744 [00:52<24:48,  2.43it/s]  3%|▎         | 125/3744 [00:52<24:13,  2.49it/s]  3%|▎         | 126/3744 [00:53<23:36,  2.56it/s]  3%|▎         | 127/3744 [00:53<24:14,  2.49it/s]  3%|▎         | 128/3744 [00:54<24:34,  2.45it/s]  3%|▎         | 129/3744 [00:54<24:08,  2.50it/s]  3%|▎         | 130/3744 [00:54<23:43,  2.54it/s]  3%|▎         | 131/3744 [00:55<23:31,  2.56it/s]  4%|▎         | 132/3744 [00:55<23:18,  2.58it/s]  4%|▎         | 133/3744 [00:55<23:15,  2.59it/s]  4%|▎         | 134/3744 [00:56<23:10,  2.60it/s]  4%|▎         | 135/3744 [00:56<24:07,  2.49it/s]  4%|▎         | 136/3744 [00:57<23:47,  2.53it/s]  4%|▎         | 137/3744 [00:57<23:33,  2.55it/s]  4%|▎         | 138/3744 [00:57<24:00,  2.50it/s]  4%|▎         | 139/3744 [00:58<23:42,  2.53it/s]  4%|▎         | 140/3744 [00:58<23:14,  2.58it/s]  4%|▍         | 141/3744 [00:59<23:09,  2.59it/s]  4%|▍         | 142/3744 [00:59<23:07,  2.60it/s]  4%|▍         | 143/3744 [00:59<24:01,  2.50it/s]  4%|▍         | 144/3744 [01:00<25:07,  2.39it/s]  4%|▍         | 145/3744 [01:00<25:53,  2.32it/s]  4%|▍         | 146/3744 [01:01<25:17,  2.37it/s]  4%|▍         | 147/3744 [01:01<25:22,  2.36it/s]  4%|▍         | 148/3744 [01:01<24:33,  2.44it/s]  4%|▍         | 149/3744 [01:02<24:22,  2.46it/s]  4%|▍         | 150/3744 [01:02<23:59,  2.50it/s]  4%|▍         | 151/3744 [01:03<23:41,  2.53it/s]  4%|▍         | 152/3744 [01:03<23:27,  2.55it/s]  4%|▍         | 153/3744 [01:03<24:03,  2.49it/s]  4%|▍         | 154/3744 [01:04<24:00,  2.49it/s]  4%|▍         | 155/3744 [01:04<24:00,  2.49it/s]  4%|▍         | 156/3744 [01:05<23:42,  2.52it/s]  4%|▍         | 157/3744 [01:05<23:29,  2.54it/s]  4%|▍         | 158/3744 [01:05<23:32,  2.54it/s]  4%|▍         | 159/3744 [01:06<23:40,  2.52it/s]  4%|▍         | 160/3744 [01:06<26:52,  2.22it/s]  4%|▍         | 161/3744 [01:07<25:35,  2.33it/s]  4%|▍         | 162/3744 [01:07<24:43,  2.41it/s]  4%|▍         | 163/3744 [01:08<24:11,  2.47it/s]  4%|▍         | 164/3744 [01:08<24:05,  2.48it/s]  4%|▍         | 165/3744 [01:08<24:22,  2.45it/s]  4%|▍         | 166/3744 [01:09<24:34,  2.43it/s]  4%|▍         | 167/3744 [01:09<24:00,  2.48it/s]  4%|▍         | 168/3744 [01:10<24:24,  2.44it/s]  5%|▍         | 169/3744 [01:10<24:36,  2.42it/s]  5%|▍         | 170/3744 [01:10<24:43,  2.41it/s]  5%|▍         | 171/3744 [01:11<24:26,  2.44it/s]  5%|▍         | 172/3744 [01:11<24:15,  2.45it/s]  5%|▍         | 173/3744 [01:12<23:46,  2.50it/s]  5%|▍         | 174/3744 [01:12<23:25,  2.54it/s]  5%|▍         | 175/3744 [01:12<23:11,  2.56it/s]  5%|▍         | 176/3744 [01:13<23:04,  2.58it/s]  5%|▍         | 177/3744 [01:13<23:41,  2.51it/s]  5%|▍         | 178/3744 [01:14<24:25,  2.43it/s]  5%|▍         | 179/3744 [01:14<25:25,  2.34it/s]  5%|▍         | 180/3744 [01:15<25:15,  2.35it/s]  5%|▍         | 181/3744 [01:15<24:33,  2.42it/s]  5%|▍         | 182/3744 [01:15<24:18,  2.44it/s]  5%|▍         | 183/3744 [01:16<25:17,  2.35it/s]  5%|▍         | 184/3744 [01:16<25:30,  2.33it/s]  5%|▍         | 185/3744 [01:17<26:01,  2.28it/s]  5%|▍         | 186/3744 [01:17<24:45,  2.40it/s]  5%|▍         | 187/3744 [01:17<24:03,  2.46it/s]  5%|▌         | 188/3744 [01:18<23:38,  2.51it/s]  5%|▌         | 189/3744 [01:18<23:37,  2.51it/s]  5%|▌         | 190/3744 [01:19<23:18,  2.54it/s]  5%|▌         | 191/3744 [01:19<23:04,  2.57it/s]  5%|▌         | 192/3744 [01:19<23:11,  2.55it/s]  5%|▌         | 193/3744 [01:20<23:43,  2.49it/s]  5%|▌         | 194/3744 [01:20<23:21,  2.53it/s]  5%|▌         | 195/3744 [01:21<23:27,  2.52it/s]  5%|▌         | 196/3744 [01:21<24:04,  2.46it/s]  5%|▌         | 197/3744 [01:21<23:22,  2.53it/s]  5%|▌         | 198/3744 [01:22<23:27,  2.52it/s]  5%|▌         | 199/3744 [01:22<23:07,  2.55it/s]  5%|▌         | 200/3744 [01:23<22:52,  2.58it/s]  5%|▌         | 201/3744 [01:23<23:07,  2.55it/s]  5%|▌         | 202/3744 [01:23<23:14,  2.54it/s]  5%|▌         | 203/3744 [01:24<23:22,  2.53it/s]  5%|▌         | 204/3744 [01:24<23:25,  2.52it/s]  5%|▌         | 205/3744 [01:24<22:53,  2.58it/s]  6%|▌         | 206/3744 [01:25<22:42,  2.60it/s]  6%|▌         | 207/3744 [01:25<22:37,  2.61it/s]  6%|▌         | 208/3744 [01:26<24:02,  2.45it/s]  6%|▌         | 209/3744 [01:26<24:13,  2.43it/s]  6%|▌         | 210/3744 [01:27<24:25,  2.41it/s]  6%|▌         | 211/3744 [01:27<24:09,  2.44it/s]  6%|▌         | 212/3744 [01:27<23:22,  2.52it/s]  6%|▌         | 213/3744 [01:28<23:06,  2.55it/s]  6%|▌         | 214/3744 [01:28<23:14,  2.53it/s]  6%|▌         | 215/3744 [01:29<23:19,  2.52it/s]  6%|▌         | 216/3744 [01:29<23:01,  2.55it/s]  6%|▌         | 217/3744 [01:29<22:49,  2.57it/s]  6%|▌         | 218/3744 [01:30<22:59,  2.56it/s]  6%|▌         | 219/3744 [01:30<22:53,  2.57it/s]  6%|▌         | 220/3744 [01:30<23:43,  2.48it/s]  6%|▌         | 221/3744 [01:31<24:00,  2.45it/s]  6%|▌         | 222/3744 [01:31<24:13,  2.42it/s]  6%|▌         | 223/3744 [01:32<25:13,  2.33it/s]  6%|▌         | 224/3744 [01:32<25:18,  2.32it/s]  6%|▌         | 225/3744 [01:33<24:42,  2.37it/s]  6%|▌         | 226/3744 [01:33<24:01,  2.44it/s]  6%|▌         | 227/3744 [01:33<23:30,  2.49it/s]  6%|▌         | 228/3744 [01:34<23:12,  2.52it/s]  6%|▌         | 229/3744 [01:34<22:41,  2.58it/s]  6%|▌         | 230/3744 [01:35<22:34,  2.59it/s]  6%|▌         | 231/3744 [01:35<22:33,  2.59it/s]  6%|▌         | 232/3744 [01:35<22:47,  2.57it/s]  6%|▌         | 233/3744 [01:36<23:18,  2.51it/s]  6%|▋         | 234/3744 [01:36<23:01,  2.54it/s]  6%|▋         | 235/3744 [01:37<23:31,  2.49it/s]  6%|▋         | 236/3744 [01:37<23:08,  2.53it/s]  6%|▋         | 237/3744 [01:37<22:50,  2.56it/s]  6%|▋         | 238/3744 [01:38<22:59,  2.54it/s]  6%|▋         | 239/3744 [01:38<23:33,  2.48it/s]  6%|▋         | 240/3744 [01:38<22:55,  2.55it/s]  6%|▋         | 241/3744 [01:39<22:46,  2.56it/s]  6%|▋         | 242/3744 [01:39<22:33,  2.59it/s]  6%|▋         | 243/3744 [01:40<22:44,  2.56it/s]  7%|▋         | 244/3744 [01:40<22:40,  2.57it/s]  7%|▋         | 245/3744 [01:40<22:49,  2.56it/s]  7%|▋         | 246/3744 [01:41<22:55,  2.54it/s]  7%|▋         | 247/3744 [01:41<22:43,  2.57it/s]  7%|▋         | 248/3744 [01:42<23:15,  2.51it/s]  7%|▋         | 249/3744 [01:42<22:58,  2.54it/s]  7%|▋         | 250/3744 [01:42<22:46,  2.56it/s]  7%|▋         | 251/3744 [01:43<23:36,  2.47it/s]  7%|▋         | 252/3744 [01:43<24:33,  2.37it/s]  7%|▋         | 253/3744 [01:44<23:52,  2.44it/s]  7%|▋         | 254/3744 [01:44<23:40,  2.46it/s]  7%|▋         | 255/3744 [01:45<23:49,  2.44it/s]  7%|▋         | 256/3744 [01:45<24:20,  2.39it/s]  7%|▋         | 257/3744 [01:45<23:42,  2.45it/s]  7%|▋         | 258/3744 [01:46<24:13,  2.40it/s]  7%|▋         | 259/3744 [01:46<24:33,  2.37it/s]  7%|▋         | 260/3744 [01:47<24:25,  2.38it/s]  7%|▋         | 261/3744 [01:47<23:44,  2.45it/s]  7%|▋         | 262/3744 [01:47<23:14,  2.50it/s]  7%|▋         | 263/3744 [01:48<23:47,  2.44it/s]  7%|▋         | 264/3744 [01:48<23:36,  2.46it/s]  7%|▋         | 265/3744 [01:49<23:46,  2.44it/s]  7%|▋         | 266/3744 [01:49<23:33,  2.46it/s]  7%|▋         | 267/3744 [01:49<23:07,  2.51it/s]  7%|▋         | 268/3744 [01:50<23:11,  2.50it/s]  7%|▋         | 269/3744 [01:50<23:11,  2.50it/s]  7%|▋         | 270/3744 [01:51<23:38,  2.45it/s]  7%|▋         | 271/3744 [01:51<23:30,  2.46it/s]  7%|▋         | 272/3744 [01:51<23:21,  2.48it/s]  7%|▋         | 273/3744 [01:52<23:17,  2.48it/s]  7%|▋         | 274/3744 [01:52<23:12,  2.49it/s]  7%|▋         | 275/3744 [01:53<22:52,  2.53it/s]  7%|▋         | 276/3744 [01:53<22:55,  2.52it/s]  7%|▋         | 277/3744 [01:53<22:23,  2.58it/s]  7%|▋         | 278/3744 [01:54<22:02,  2.62it/s]  7%|▋         | 279/3744 [01:54<22:45,  2.54it/s]  7%|▋         | 280/3744 [01:55<22:29,  2.57it/s]  8%|▊         | 281/3744 [01:55<23:12,  2.49it/s]  8%|▊         | 282/3744 [01:55<22:48,  2.53it/s]  8%|▊         | 283/3744 [01:56<23:11,  2.49it/s]  8%|▊         | 284/3744 [01:56<23:28,  2.46it/s]  8%|▊         | 285/3744 [01:57<23:18,  2.47it/s]  8%|▊         | 286/3744 [01:57<22:53,  2.52it/s]  8%|▊         | 287/3744 [01:57<22:55,  2.51it/s]  8%|▊         | 288/3744 [01:58<22:41,  2.54it/s]  8%|▊         | 289/3744 [01:58<23:11,  2.48it/s]  8%|▊         | 290/3744 [01:59<22:47,  2.52it/s]  8%|▊         | 291/3744 [01:59<22:51,  2.52it/s]  8%|▊         | 292/3744 [01:59<22:38,  2.54it/s]  8%|▊         | 293/3744 [02:00<22:41,  2.54it/s]  8%|▊         | 294/3744 [02:00<23:23,  2.46it/s]  8%|▊         | 295/3744 [02:01<23:12,  2.48it/s]  8%|▊         | 296/3744 [02:01<23:09,  2.48it/s]  8%|▊         | 297/3744 [02:01<23:05,  2.49it/s]  8%|▊         | 298/3744 [02:02<23:01,  2.50it/s]  8%|▊         | 299/3744 [02:02<24:09,  2.38it/s]  8%|▊         | 300/3744 [02:03<24:14,  2.37it/s]  8%|▊         | 301/3744 [02:03<24:07,  2.38it/s]  8%|▊         | 302/3744 [02:03<23:24,  2.45it/s]  8%|▊         | 303/3744 [02:04<22:58,  2.50it/s]  8%|▊         | 304/3744 [02:04<23:30,  2.44it/s]  8%|▊         | 305/3744 [02:05<23:17,  2.46it/s]  8%|▊         | 306/3744 [02:05<22:54,  2.50it/s]  8%|▊         | 307/3744 [02:05<22:37,  2.53it/s]  8%|▊         | 308/3744 [02:06<22:43,  2.52it/s]  8%|▊         | 309/3744 [02:06<23:05,  2.48it/s]  8%|▊         | 310/3744 [02:07<22:57,  2.49it/s]  8%|▊         | 311/3744 [02:07<23:12,  2.46it/s]  8%|▊         | 312/3744 [02:08<23:43,  2.41it/s]  8%|▊         | 313/3744 [02:08<24:08,  2.37it/s]  8%|▊         | 314/3744 [02:08<23:47,  2.40it/s]  8%|▊         | 315/3744 [02:09<24:03,  2.38it/s]  8%|▊         | 316/3744 [02:09<23:18,  2.45it/s]  8%|▊         | 317/3744 [02:10<22:46,  2.51it/s]  8%|▊         | 318/3744 [02:10<22:31,  2.54it/s]  9%|▊         | 319/3744 [02:10<22:14,  2.57it/s]  9%|▊         | 320/3744 [02:11<22:23,  2.55it/s]  9%|▊         | 321/3744 [02:11<22:09,  2.57it/s]  9%|▊         | 322/3744 [02:12<22:57,  2.48it/s]  9%|▊         | 323/3744 [02:12<23:17,  2.45it/s]  9%|▊         | 324/3744 [02:12<23:08,  2.46it/s]  9%|▊         | 325/3744 [02:13<23:33,  2.42it/s]  9%|▊         | 326/3744 [02:13<23:19,  2.44it/s]  9%|▊         | 327/3744 [02:14<22:34,  2.52it/s]  9%|▉         | 328/3744 [02:14<22:05,  2.58it/s]  9%|▉         | 329/3744 [02:14<22:45,  2.50it/s]  9%|▉         | 330/3744 [02:15<22:46,  2.50it/s]  9%|▉         | 331/3744 [02:15<22:45,  2.50it/s]  9%|▉         | 332/3744 [02:16<22:26,  2.53it/s]  9%|▉         | 333/3744 [02:16<22:31,  2.52it/s]  9%|▉         | 334/3744 [02:16<22:18,  2.55it/s]  9%|▉         | 335/3744 [02:17<22:24,  2.54it/s]  9%|▉         | 336/3744 [02:17<23:37,  2.40it/s]  9%|▉         | 337/3744 [02:18<23:47,  2.39it/s]  9%|▉         | 338/3744 [02:18<23:06,  2.46it/s]  9%|▉         | 339/3744 [02:18<22:56,  2.47it/s]  9%|▉         | 340/3744 [02:19<23:26,  2.42it/s]  9%|▉         | 341/3744 [02:19<23:36,  2.40it/s]  9%|▉         | 342/3744 [02:20<23:49,  2.38it/s]  9%|▉         | 343/3744 [02:20<23:45,  2.39it/s]  9%|▉         | 344/3744 [02:20<23:05,  2.45it/s]  9%|▉         | 345/3744 [02:21<22:37,  2.50it/s]  9%|▉         | 346/3744 [02:21<22:18,  2.54it/s]  9%|▉         | 347/3744 [02:22<22:05,  2.56it/s]  9%|▉         | 348/3744 [02:22<22:14,  2.54it/s]  9%|▉         | 349/3744 [02:22<21:59,  2.57it/s]  9%|▉         | 350/3744 [02:23<21:37,  2.62it/s]  9%|▉         | 351/3744 [02:23<22:31,  2.51it/s]  9%|▉         | 352/3744 [02:24<23:35,  2.40it/s]  9%|▉         | 353/3744 [02:24<23:01,  2.45it/s]  9%|▉         | 354/3744 [02:24<23:21,  2.42it/s]  9%|▉         | 355/3744 [02:25<22:33,  2.50it/s] 10%|▉         | 356/3744 [02:25<22:12,  2.54it/s] 10%|▉         | 357/3744 [02:26<22:18,  2.53it/s] 10%|▉         | 358/3744 [02:26<22:02,  2.56it/s] 10%|▉         | 359/3744 [02:26<22:10,  2.54it/s] 10%|▉         | 360/3744 [02:27<21:56,  2.57it/s] 10%|▉         | 361/3744 [02:27<21:50,  2.58it/s] 10%|▉         | 362/3744 [02:28<22:03,  2.56it/s] 10%|▉         | 363/3744 [02:28<22:28,  2.51it/s] 10%|▉         | 364/3744 [02:28<22:11,  2.54it/s] 10%|▉         | 365/3744 [02:29<22:47,  2.47it/s] 10%|▉         | 366/3744 [02:29<22:42,  2.48it/s] 10%|▉         | 367/3744 [02:30<22:37,  2.49it/s] 10%|▉         | 368/3744 [02:30<23:11,  2.43it/s] 10%|▉         | 369/3744 [02:30<22:43,  2.48it/s] 10%|▉         | 370/3744 [02:31<22:39,  2.48it/s] 10%|▉         | 371/3744 [02:31<22:20,  2.52it/s] 10%|▉         | 372/3744 [02:32<22:00,  2.55it/s] 10%|▉         | 373/3744 [02:32<22:09,  2.54it/s] 10%|▉         | 374/3744 [02:32<22:09,  2.53it/s] 10%|█         | 375/3744 [02:33<22:13,  2.53it/s] 10%|█         | 376/3744 [02:33<21:55,  2.56it/s] 10%|█         | 377/3744 [02:34<22:01,  2.55it/s] 10%|█         | 378/3744 [02:34<22:34,  2.49it/s] 10%|█         | 379/3744 [02:34<22:14,  2.52it/s] 10%|█         | 380/3744 [02:35<22:40,  2.47it/s] 10%|█         | 381/3744 [02:35<23:03,  2.43it/s] 10%|█         | 382/3744 [02:36<23:18,  2.40it/s] 10%|█         | 383/3744 [02:36<22:42,  2.47it/s] 10%|█         | 384/3744 [02:36<22:04,  2.54it/s] 10%|█         | 385/3744 [02:37<22:32,  2.48it/s] 10%|█         | 386/3744 [02:37<22:48,  2.45it/s] 10%|█         | 387/3744 [02:38<22:41,  2.47it/s] 10%|█         | 388/3744 [02:38<22:16,  2.51it/s] 10%|█         | 389/3744 [02:38<22:57,  2.44it/s] 10%|█         | 390/3744 [02:39<22:42,  2.46it/s] 10%|█         | 391/3744 [02:39<22:37,  2.47it/s] 10%|█         | 392/3744 [02:40<22:31,  2.48it/s] 10%|█         | 393/3744 [02:40<22:28,  2.48it/s] 11%|█         | 394/3744 [02:40<22:22,  2.50it/s] 11%|█         | 395/3744 [02:41<22:02,  2.53it/s] 11%|█         | 396/3744 [02:41<22:30,  2.48it/s] 11%|█         | 397/3744 [02:42<22:10,  2.52it/s] 11%|█         | 398/3744 [02:42<22:39,  2.46it/s] 11%|█         | 399/3744 [02:42<22:18,  2.50it/s] 11%|█         | 400/3744 [02:43<22:52,  2.44it/s] 11%|█         | 401/3744 [02:43<22:25,  2.49it/s] 11%|█         | 402/3744 [02:44<22:06,  2.52it/s] 11%|█         | 403/3744 [02:44<22:37,  2.46it/s] 11%|█         | 404/3744 [02:44<22:10,  2.51it/s] 11%|█         | 405/3744 [02:45<22:48,  2.44it/s] 11%|█         | 406/3744 [02:45<23:09,  2.40it/s] 11%|█         | 407/3744 [02:46<22:30,  2.47it/s] 11%|█         | 408/3744 [02:46<22:22,  2.48it/s] 11%|█         | 409/3744 [02:47<22:58,  2.42it/s] 11%|█         | 410/3744 [02:47<22:22,  2.48it/s] 11%|█         | 411/3744 [02:47<22:18,  2.49it/s] 11%|█         | 412/3744 [02:48<21:58,  2.53it/s] 11%|█         | 413/3744 [02:48<21:42,  2.56it/s] 11%|█         | 414/3744 [02:48<21:35,  2.57it/s] 11%|█         | 415/3744 [02:49<22:08,  2.51it/s] 11%|█         | 416/3744 [02:49<21:52,  2.54it/s] 11%|█         | 417/3744 [02:50<23:07,  2.40it/s] 11%|█         | 418/3744 [02:50<22:50,  2.43it/s] 11%|█         | 419/3744 [02:51<22:39,  2.45it/s] 11%|█         | 420/3744 [02:51<22:50,  2.43it/s] 11%|█         | 421/3744 [02:51<22:56,  2.41it/s] 11%|█▏        | 422/3744 [02:52<22:20,  2.48it/s] 11%|█▏        | 423/3744 [02:52<21:44,  2.55it/s] 11%|█▏        | 424/3744 [02:52<21:33,  2.57it/s] 11%|█▏        | 425/3744 [02:53<22:08,  2.50it/s] 11%|█▏        | 426/3744 [02:53<22:25,  2.47it/s] 11%|█▏        | 427/3744 [02:54<22:20,  2.47it/s] 11%|█▏        | 428/3744 [02:54<21:44,  2.54it/s] 11%|█▏        | 429/3744 [02:54<21:35,  2.56it/s] 11%|█▏        | 430/3744 [02:55<21:46,  2.54it/s] 12%|█▏        | 431/3744 [02:55<21:49,  2.53it/s] 12%|█▏        | 432/3744 [02:56<21:33,  2.56it/s] 12%|█▏        | 433/3744 [02:56<22:13,  2.48it/s] 12%|█▏        | 434/3744 [02:57<22:40,  2.43it/s] 12%|█▏        | 435/3744 [02:57<22:14,  2.48it/s] 12%|█▏        | 436/3744 [02:57<21:53,  2.52it/s] 12%|█▏        | 437/3744 [02:58<21:42,  2.54it/s] 12%|█▏        | 438/3744 [02:58<22:16,  2.47it/s] 12%|█▏        | 439/3744 [02:58<21:34,  2.55it/s] 12%|█▏        | 440/3744 [02:59<22:05,  2.49it/s] 12%|█▏        | 441/3744 [02:59<22:02,  2.50it/s] 12%|█▏        | 442/3744 [03:00<22:24,  2.46it/s] 12%|█▏        | 443/3744 [03:00<21:59,  2.50it/s] 12%|█▏        | 444/3744 [03:00<21:43,  2.53it/s] 12%|█▏        | 445/3744 [03:01<21:45,  2.53it/s] 12%|█▏        | 446/3744 [03:01<21:32,  2.55it/s] 12%|█▏        | 447/3744 [03:02<21:19,  2.58it/s] 12%|█▏        | 448/3744 [03:02<21:29,  2.56it/s] 12%|█▏        | 449/3744 [03:02<21:56,  2.50it/s] 12%|█▏        | 450/3744 [03:03<22:22,  2.45it/s] 12%|█▏        | 451/3744 [03:03<21:56,  2.50it/s] 12%|█▏        | 452/3744 [03:04<22:32,  2.43it/s] 12%|█▏        | 453/3744 [03:04<22:38,  2.42it/s] 12%|█▏        | 454/3744 [03:05<22:23,  2.45it/s] 12%|█▏        | 455/3744 [03:05<22:51,  2.40it/s] 12%|█▏        | 456/3744 [03:05<22:32,  2.43it/s] 12%|█▏        | 457/3744 [03:06<21:50,  2.51it/s] 12%|█▏        | 458/3744 [03:06<22:56,  2.39it/s] 12%|█▏        | 459/3744 [03:07<22:54,  2.39it/s] 12%|█▏        | 460/3744 [03:07<23:06,  2.37it/s] 12%|█▏        | 461/3744 [03:07<22:44,  2.41it/s] 12%|█▏        | 462/3744 [03:08<22:44,  2.40it/s] 12%|█▏        | 463/3744 [03:08<22:29,  2.43it/s] 12%|█▏        | 464/3744 [03:09<21:57,  2.49it/s] 12%|█▏        | 465/3744 [03:09<22:14,  2.46it/s] 12%|█▏        | 466/3744 [03:09<21:50,  2.50it/s] 12%|█▏        | 467/3744 [03:10<21:50,  2.50it/s] 12%|█▎        | 468/3744 [03:10<22:17,  2.45it/s]Traceback (most recent call last):
  File "/gpfs/gpfs0/project/SDS/research/christ_research/Llama 2/llama2-70b/text_classifier.py", line 176, in <module>
    trainer.train()
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/transformers/trainer.py", line 1539, in train
    return inner_training_loop(
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/transformers/trainer.py", line 1916, in _inner_training_loop
    self._maybe_log_save_evaluate(tr_loss, model, trial, epoch, ignore_keys_for_eval)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/transformers/trainer.py", line 2226, in _maybe_log_save_evaluate
    metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/transformers/trainer.py", line 2934, in evaluate
    output = eval_loop(
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/transformers/trainer.py", line 3123, in evaluation_loop
    loss, logits, labels = self.prediction_step(model, inputs, prediction_loss_only, ignore_keys=ignore_keys)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/transformers/trainer.py", line 3337, in prediction_step
    loss, outputs = self.compute_loss(model, inputs, return_outputs=True)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/transformers/trainer.py", line 2679, in compute_loss
    outputs = model(**inputs)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/accelerate/utils/operations.py", line 581, in forward
    return model_forward(*args, **kwargs)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/accelerate/utils/operations.py", line 569, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/torch/amp/autocast_mode.py", line 14, in decorate_autocast
    return func(*args, **kwargs)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/peft/peft_model.py", line 736, in forward
    return self.base_model(
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 945, in forward
    transformer_outputs = self.model(
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 693, in forward
    layer_outputs = decoder_layer(
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 408, in forward
    hidden_states, self_attn_weights, present_key_value = self.self_attn(
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = old_forward(*args, **kwargs)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/transformers/models/llama/modeling_llama.py", line 330, in forward
    attn_weights = torch.matmul(query_states, key_states.transpose(2, 3)) / math.sqrt(self.head_dim)
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling `cublasGemmStridedBatchedExFix(handle, opa, opb, (int)m, (int)n, (int)k, (void*)&falpha, a, CUDA_R_16BF, (int)lda, stridea, b, CUDA_R_16BF, (int)ldb, strideb, (void*)&fbeta, c, CUDA_R_16BF, (int)ldc, stridec, (int)num_batches, CUDA_R_32F, CUBLAS_GEMM_DEFAULT_TENSOR_OP)`
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.014 MB of 0.014 MB uploaded (0.000 MB deduped)wandb: \ 0.035 MB of 0.035 MB uploaded (0.000 MB deduped)wandb: 🚀 View run light-valley-23 at: https://wandb.ai/christ_research/huggingface/runs/4432da36
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230804_114659-4432da36/logs
Exception in thread NetStatThr:
Traceback (most recent call last):
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/threading.py", line 980, in _bootstrap_inner
    self.run()
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/threading.py", line 917, in run
    self._target(*self._args, **self._kwargs)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 260, in check_network_status
    self._loop_check_status(
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 216, in _loop_check_status
    local_handle = request()
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/wandb/sdk/interface/interface.py", line 795, in deliver_network_status
    return self._deliver_network_status(status)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 601, in _deliver_network_status
    return self._deliver_record(record)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 560, in _deliver_record
    handle = mailbox._deliver_record(record, interface=self)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/wandb/sdk/lib/mailbox.py", line 455, in _deliver_record
    interface._publish(record)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/wandb/sdk/interface/interface_sock.py", line 51, in _publish
    self._sock_client.send_record_publish(record)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 221, in send_record_publish
    self.send_server_request(server_req)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 155, in send_server_request
    self._send_message(msg)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 152, in _send_message
    self._sendall_with_error_handle(header + data)
  File "/home/brc4cb/.conda/envs/falcon_40B/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
BrokenPipeError: [Errno 32] Broken pipe
